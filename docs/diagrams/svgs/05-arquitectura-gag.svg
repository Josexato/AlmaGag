<?xml version="1.0" encoding="utf-8" ?>
<svg baseProfile="full" height="1100" version="1.1" viewBox="0,0,1479.0,1100" width="1479.0" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><marker id="arrow-end" markerHeight="10" markerWidth="10" orient="auto" refX="10" refY="5"><path d="M 0 0 L 10 5 L 0 10 z" fill="black" /></marker><marker id="arrow-start" markerHeight="10" markerWidth="10" orient="auto" refX="0" refY="5"><path d="M 10 0 L 0 5 L 10 10 z" fill="black" /></marker><linearGradient id="gradient-layout_container" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#eeeeff" /><stop offset="100%" stop-color="#a2a2b2" /></linearGradient><linearGradient id="gradient-layout_container_icon" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#eeeeff" /><stop offset="100%" stop-color="#a2a2b2" /></linearGradient><linearGradient id="gradient-routing_container" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#ffeeee" /><stop offset="100%" stop-color="#b2a2a2" /></linearGradient><linearGradient id="gradient-routing_container_icon" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#ffeeee" /><stop offset="100%" stop-color="#b2a2a2" /></linearGradient><linearGradient id="gradient-analysis_container" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#fffaee" /><stop offset="100%" stop-color="#b2ada2" /></linearGradient><linearGradient id="gradient-analysis_container_icon" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#fffaee" /><stop offset="100%" stop-color="#b2ada2" /></linearGradient><linearGradient id="gradient-draw_container" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#f4eeff" /><stop offset="100%" stop-color="#a8a2b2" /></linearGradient><linearGradient id="gradient-draw_container_icon" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#f4eeff" /><stop offset="100%" stop-color="#a8a2b2" /></linearGradient><linearGradient id="gradient-input" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#c5e3ed" /><stop offset="100%" stop-color="#7997a1" /></linearGradient><linearGradient id="gradient-main" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#b1f3b1" /><stop offset="100%" stop-color="#64a664" /></linearGradient><linearGradient id="gradient-generator" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#ffe34c" /><stop offset="100%" stop-color="#b29600" /></linearGradient><linearGradient id="gradient-svgwrite" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#4cffff" /><stop offset="100%" stop-color="#00b2b2" /></linearGradient><linearGradient id="gradient-layout" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#a6a6a6" /><stop offset="100%" stop-color="#595959" /></linearGradient><linearGradient id="gradient-sizing" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#a6a6a6" /><stop offset="100%" stop-color="#595959" /></linearGradient><linearGradient id="gradient-positioner" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#a6a6a6" /><stop offset="100%" stop-color="#595959" /></linearGradient><linearGradient id="gradient-optimizer" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#ff917e" /><stop offset="100%" stop-color="#b24531" /></linearGradient><linearGradient id="gradient-router_mgr" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#ff9797" /><stop offset="100%" stop-color="#b24a4a" /></linearGradient><linearGradient id="gradient-routers" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#ffbca1" /><stop offset="100%" stop-color="#b27055" /></linearGradient><linearGradient id="gradient-geometry" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#ffc04c" /><stop offset="100%" stop-color="#b27300" /></linearGradient><linearGradient id="gradient-graph" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#a6a6a6" /><stop offset="100%" stop-color="#595959" /></linearGradient><linearGradient id="gradient-collision" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#a6a6a6" /><stop offset="100%" stop-color="#595959" /></linearGradient><linearGradient id="gradient-render" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#a64ca6" /><stop offset="100%" stop-color="#590059" /></linearGradient><linearGradient id="gradient-icons" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#a64ca6" /><stop offset="100%" stop-color="#590059" /></linearGradient><linearGradient id="gradient-connections" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#ffc04c" /><stop offset="100%" stop-color="#b27300" /></linearGradient><linearGradient id="gradient-labels" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#ffd2da" /><stop offset="100%" stop-color="#b2868e" /></linearGradient><linearGradient id="gradient-containers" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#a6a6a6" /><stop offset="100%" stop-color="#595959" /></linearGradient><linearGradient id="gradient-output" x1="0%" x2="0%" y1="0%" y2="100%"><stop offset="0%" stop-color="#b1f3b1" /><stop offset="100%" stop-color="#64a664" /></linearGradient></defs><rect fill="url(#gradient-layout_container)" height="223" opacity="0.3" rx="11.15" ry="11.15" stroke="black" stroke-width="2" width="246" x="111.0" y="20" /><rect fill="url(#gradient-layout_container_icon)" height="50" stroke="black" width="80" x="121.0" y="20" /><rect fill="url(#gradient-routing_container)" height="153" opacity="0.3" rx="7.65" ry="7.65" stroke="black" stroke-width="2" width="222" x="557.0" y="20" /><rect fill="url(#gradient-routing_container_icon)" height="50" stroke="black" width="80" x="567.0" y="20" /><rect fill="url(#gradient-analysis_container)" height="223" opacity="0.3" rx="11.15" ry="11.15" stroke="black" stroke-width="2" width="230" x="819.0" y="20" /><rect fill="url(#gradient-analysis_container_icon)" height="50" stroke="black" width="80" x="829.0" y="20" /><rect fill="url(#gradient-draw_container)" height="223" opacity="0.3" rx="10.0" ry="10.0" stroke="black" stroke-width="2" width="200" x="1089.0" y="20" /><rect fill="url(#gradient-draw_container_icon)" height="50" stroke="black" width="80" x="1099.0" y="20" /><rect fill="url(#gradient-input)" height="30.0" stroke="black" width="60.0" x="530.0" y="681.5" /><rect fill="url(#gradient-main)" height="50" stroke="black" width="80" x="600.0" y="671.5" /><rect fill="url(#gradient-generator)" height="50" stroke="black" width="80" x="700.0" y="671.5" /><ellipse cx="740.0" cy="696.5" fill="url(#gradient-svgwrite)" rx="40.0" ry="25.0" stroke="black" /><rect fill="url(#gradient-layout)" height="50" stroke="black" width="80" x="121.0" y="80" /><rect fill="url(#gradient-sizing)" height="30.0" stroke="black" width="60.0" x="231.0" y="90.0" /><rect fill="url(#gradient-positioner)" height="30.0" stroke="black" width="60.0" x="131.0" y="160.0" /><rect fill="url(#gradient-optimizer)" height="50" stroke="black" width="80" x="640.0" y="671.5" /><rect fill="url(#gradient-router_mgr)" height="50" stroke="black" width="80" x="567.0" y="80" /><ellipse cx="707.0" cy="105.0" fill="url(#gradient-routers)" rx="40.0" ry="25.0" stroke="black" /><rect fill="url(#gradient-geometry)" height="30.0" stroke="black" width="60.0" x="839.0" y="90.0" /><rect fill="url(#gradient-graph)" height="30.0" stroke="black" width="60.0" x="939.0" y="90.0" /><rect fill="url(#gradient-collision)" height="30.0" stroke="black" width="60.0" x="839.0" y="160.0" /><rect fill="url(#gradient-render)" height="50" stroke="black" width="80" x="720.0" y="671.5" /><rect fill="url(#gradient-icons)" height="30.0" stroke="black" width="60.0" x="1109.0" y="90.0" /><rect fill="url(#gradient-connections)" height="30.0" stroke="black" width="60.0" x="1209.0" y="90.0" /><rect fill="url(#gradient-labels)" height="30.0" stroke="black" width="60.0" x="1109.0" y="160.0" /><rect fill="url(#gradient-containers)" height="30.0" stroke="black" width="60.0" x="1209.0" y="160.0" /><rect fill="url(#gradient-output)" height="30.0" stroke="black" width="60.0" x="810.0" y="681.5" /><line marker-end="url(#arrow-end)" stroke="black" stroke-width="2" x1="591.8602952338972" x2="608.1397047661028" y1="701.0130973218221" y2="699.4869026781779" /><line marker-end="url(#arrow-end)" stroke="black" stroke-width="2" x1="671.8025442818458" x2="720.1974557181542" y1="700.0493911028846" y2="705.4506088971154" /><path d="M 729.8389814979291,685.9156057270095 C 750.5,702.4333333333334 746.5,698.2666666666667 767.7012731275886,725.3554928412381" fill="none" marker-end="url(#arrow-end)" stroke="black" stroke-width="2" /><polyline fill="none" marker-end="url(#arrow-end)" points="752.0,677.0 752.0,409.5 161.0,409.5 161.0,142.0" stroke="black" stroke-width="2" /><polyline fill="none" marker-end="url(#arrow-end)" points="193.0,110.0 211.0,110.0 211.0,105.0 229.0,105.0" stroke="black" stroke-width="2" /><polyline fill="none" marker-end="url(#arrow-end)" points="161.0,142.0 161.0,143.0" stroke="black" stroke-width="2" /><line marker-end="url(#arrow-end)" stroke="black" stroke-width="2" x1="182.25719484235037" x2="678.7428051576496" y1="133.91927397381352" y2="692.5807260261864" /><polyline fill="none" marker-end="url(#arrow-end)" points="700.0,684.5 700.0,413.25 607.0,413.25 607.0,142.0" stroke="black" stroke-width="2" /><polyline fill="none" marker-end="url(#arrow-end)" points="639.0,110.0 657.0,110.0 657.0,112.5 667.0,112.5" stroke="black" stroke-width="2" /><polyline fill="none" marker-end="url(#arrow-end)" points="700.0,684.5 700.0,410.75 869.0,410.75 869.0,137.0" stroke="black" stroke-width="2" /><path d="M 712.8852277472695,687.208859600538 C 942.5416666666666,579.9166666666666 1032.2083333333335,376.0833333333333 956.1147722527305,134.29114039946202" fill="none" marker-end="url(#arrow-end)" stroke="black" stroke-width="2" /><path d="M 709.5335569684503,685.9531295951728 C 891.7083333333334,578.25 948.0416666666666,397.75 859.4664430315497,205.5468704048273" fill="none" marker-end="url(#arrow-end)" stroke="black" stroke-width="2" /><polyline fill="none" marker-end="url(#arrow-end)" points="869.0,143.0 869.0,137.0" stroke="black" stroke-width="2" /><path d="M 293.0,105.0 C 463.66666666666663,287.4 666.3333333333333,287.4 837.0,105.0" fill="none" marker-end="url(#arrow-end)" stroke="black" stroke-width="2" /><line marker-end="url(#arrow-end)" stroke="black" stroke-width="2" x1="731.7528920548374" x2="728.2471079451626" y1="712.5308884931453" y2="712.9691115068547" /><polyline fill="none" marker-end="url(#arrow-end)" points="760.0,677.0 760.0,407.0 1139.0,407.0 1139.0,137.0" stroke="black" stroke-width="2" /><polyline fill="none" marker-end="url(#arrow-end)" points="760.0,677.0 760.0,410.75 1239.0,410.75 1239.0,144.5" stroke="black" stroke-width="2" /><polyline fill="none" marker-end="url(#arrow-end)" points="760.0,677.0 760.0,442.0 1139.0,442.0 1139.0,207.0" stroke="black" stroke-width="2" /><polyline fill="none" marker-end="url(#arrow-end)" points="760.0,677.0 760.0,442.0 1239.0,442.0 1239.0,207.0" stroke="black" stroke-width="2" /><path d="M 1207.000250357581,112.37341871185752 C 1029.2083333333333,-109.53333333333332 818.5416666666667,-110.36666666666666 638.9997496424189,110.12658128814248" fill="none" marker-end="url(#arrow-end)" stroke="black" stroke-width="2" /><polyline fill="none" marker-end="url(#arrow-end)" points="1139.0,137.0 1139.0,404.5 840.0,404.5 840.0,672.0" stroke="black" stroke-width="2" /><polyline fill="none" marker-end="url(#arrow-end)" points="1239.0,144.5 1239.0,408.25 840.0,408.25 840.0,672.0" stroke="black" stroke-width="2" /><polyline fill="none" marker-end="url(#arrow-end)" points="1139.0,207.0 1139.0,439.5 840.0,439.5 840.0,672.0" stroke="black" stroke-width="2" /><polyline fill="none" marker-end="url(#arrow-end)" points="1239.0,207.0 1239.0,439.5 840.0,439.5 840.0,672.0" stroke="black" stroke-width="2" /><path d="M 880.0,716.0 A 70,70 0 0,1 880.0,692.0" fill="none" marker-end="url(#arrow-end)" stroke="black" stroke-width="2" /><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="end" x="507.4" y="696.5">archivo.gag
(JSON SDJF v3.0)</text><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="middle" x="640.0" y="650.5">main.py
(CLI)</text><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="middle" x="740.0" y="742.5">generator.py
(orquestador)</text><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="middle" x="740.0" y="742.5">svgwrite
(librería externa)</text><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="middle" x="161.0" y="59.0">Layout
Patrón Inmutable</text><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="start" x="313.6" y="105.0">SizingCalculator
hp/wp (v3.0)</text><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="middle" x="161.0" y="221.0">AutoLayoutPositioner
Layout jerárquico</text><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="end" x="627.4" y="696.5">AutoLayoutOptimizer
v3.0 Jerárquico</text><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="middle" x="607.0" y="151.0">RouterManager
Coordinador</text><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="middle" x="707.0" y="151.0">5 Routers
straight/orthogonal
bezier/arc/manual</text><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="middle" x="869.0" y="59.0">GeometryCalculator
bboxes
intersecciones</text><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="middle" x="969.0" y="151.0">GraphAnalyzer
topología (v3.0)
niveles
grupos</text><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="end" x="816.4" y="175.0">CollisionDetector
detect_all()
count()</text><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="middle" x="760.0" y="742.5">Renderizado SVG
(3 fases secuenciales)</text><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="middle" x="1139.0" y="59.0">icons.py
Fase 1: Shapes
4 tipos + BWT</text><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="start" x="1291.6" y="105.0">connections.py
Fase 2: Lines
Routing types (v3.0)</text><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="end" x="1086.4" y="175.0">labels
Fase 3: Text
draw_*_label()</text><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="start" x="1291.6" y="175.0">container.py
Agrupación visual
(v1.5)</text><text fill="black" font-family="Arial, sans-serif" font-size="14px" text-anchor="start" x="892.6" y="696.5">archivo.svg
(Salida vectorial)</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="middle" x="600.0" y="657.25">lee JSON</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="middle" x="696.0" y="745.75">generate_diagram()</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="middle" x="748.7701273127589" y="662.6355492841237">Drawing()</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="end" x="405.7" y="409.5">Layout(...)</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="middle" x="211.0" y="64.5">usa</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="end" x="110.2" y="142.5">usa</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="start" x="481.3" y="413.25">optimize()</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="end" x="602.7" y="370.25">calculate_all_paths()
v3.0</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="middle" x="655.0" y="68.25">delega</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="middle" x="784.5" y="453.75">usa</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="end" x="783.7" y="367.75">analyze()</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="end" x="733.7" y="445.75">evaluate()</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="middle" x="869.0" y="97.0">usa bboxes</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="end" x="514.2" y="62.0">calcula tamaños</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="start" x="780.8" y="712.75">layout optimizado</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="middle" x="949.5" y="364.0">fase 1</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="start" x="1050.3" y="453.75">fase 2</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="end" x="898.7" y="442.0">fase 3</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="start" x="1050.3" y="485.0">si usa contains</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="start" x="973.8" y="68.25">lee computed_path</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="end" x="938.7" y="361.5">dwg.add()</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="start" x="1090.3" y="408.25">dwg.add()</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="start" x="1040.3" y="482.5">dwg.add()</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="start" x="1090.3" y="396.5">dwg.add()</text><text fill="gray" font-family="Arial, sans-serif" font-size="12px" text-anchor="middle" x="950.0" y="661.0">dwg.save()</text><text fill="black" font-family="Arial, sans-serif" font-size="16px" font-weight="bold" text-anchor="start" x="211.0" y="36">Layout Module</text><text fill="black" font-family="Arial, sans-serif" font-size="16px" font-weight="bold" text-anchor="start" x="211.0" y="54">(jerárquico v3.0)</text><text fill="black" font-family="Arial, sans-serif" font-size="16px" font-weight="bold" text-anchor="start" x="657.0" y="36">Routing Module</text><text fill="black" font-family="Arial, sans-serif" font-size="16px" font-weight="bold" text-anchor="start" x="657.0" y="54">(v3.0)</text><text fill="black" font-family="Arial, sans-serif" font-size="16px" font-weight="bold" text-anchor="start" x="919.0" y="36">Analysis Module</text><text fill="black" font-family="Arial, sans-serif" font-size="16px" font-weight="bold" text-anchor="start" x="1189.0" y="36">Draw Module</text></svg>